FROM ruby:2.2.1
MAINTAINER Nicolas Corrarello <nicolas@corrarello.com>

RUN apt-get update && \
    apt-get install -y net-tools

    # Install gems
    ENV APP_HOME /app
    ENV HOME /root
    RUN mkdir $APP_HOME
    WORKDIR $APP_HOME
    RUN curl -O $APP_HOME/Gemfile https://raw.githubusercontent.com/ncorrare/worldofcontainers/1.0.0/api/Gemfile 
    RUN bundle install
    RUN curl -O $APP_HOME/api.rb https://raw.githubusercontent.com/ncorrare/worldofcontainers/1.0.0/api/countriesapi.rb
    VOLUME /config
    COPY /config/config.yaml $APP_HOME/config.yaml
    # Start server
    ENV PORT 3000
    EXPOSE 3000
    CMD ["ruby", "api.rb"]
